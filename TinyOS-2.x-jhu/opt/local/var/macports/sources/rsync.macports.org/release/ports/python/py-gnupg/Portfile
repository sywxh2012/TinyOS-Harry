# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 85165 2011-10-10 18:28:54Z snc@macports.org $

PortSystem          1.0
PortGroup           python 1.0

name                py-gnupg
version             0.3.2
if {$subport == "py24-gnupg"} {
    revision            1
}
python.versions     24 25 26 27
# must default to python2.4
categories          python
platforms           darwin
maintainers         snc openmaintainer
license             LGPL-2.1

description         GnuPGInterface is a Python module to interface with GnuPG
long_description    GnuPGInterface is a Python module to interface with \
                    GnuPG. It concentrates on interacting with GnuPG via filehandles, \
                    providing access to control GnuPG via versatile and extensible means.

homepage            http://py-gnupg.sourceforge.net/
master_sites        sourceforge:py-gnupg
distname            GnuPGInterface-${version}

checksums           rmd160  7bc5ae75bf17203442cfda8bbdb430b2f02fdd75 \
                    sha256  0ea672251e2e3f71b62fef0c01539519d500f6b338f803af6b57e67a73cca8e6

universal_variant   no

if {$subport != $name} {
    patchfiles          patch-setup.py.diff

    depends_lib-append  port:gnupg

    post-extract {
        fs-traverse dir ${workpath} {
            if {[file isdirectory ${dir}]} {
                file attributes ${dir} -permissions 0755
            } elseif {[file isfile ${dir}]} {
                file attributes ${dir} -permissions 0644
            }
        }
    }

    post-patch {
        reinplace "s|VERSION|${version}|g" ${worksrcpath}/setup.py
    }

    test.run            yes
    test.cmd            ${python.bin} unittests.py
    test.target

    post-destroot {
        xinstall -m 644 -W ${worksrcpath} COPYING ChangeLog NEWS README \
            THANKS ${destroot}${prefix}/share/doc/${subport}
    }

    livecheck.type      none
} else {
    livecheck.distname  GnuPGInterface
}
